Here is the riddle:

A warden of a jail assembles 300 inmates and tells them the following:

From this night on I will separate you and you will have no contact one with
the other (each one will be in a different cell).

I have a special cell here at the jail. Each night I will randomly (and with
possible repetitions) select one amongst you to sleep there. This room has a
light (on/off switch) which you may use.

One of you must, at some point, proclaim that all inmates have already visited
the special room. If the proclamation is false you will all die. If you never
proclaim this then, naturaly, you will all be imprisoned for life.

You may take some time to talk amongst yourselves and plan your strategy.

Can you plan the strategy for the inmates ?
How long will it take, on average, for the inmates to go free ?
Can you prove that it is the best strategy ? (hard)
